<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEDAT - Excel Data Processor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* General Styling */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #F6F6F6;
            min-height: 100vh;
            padding: 20px;
            color: #111111;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Animated Liquid Background */
        .liquid-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .liquid-background .shape {
            position: absolute;
            border-radius: 50%;
            filter: blur(120px);
            opacity: 0.25;
        }

        .shape1 {
            width: 600px;
            height: 600px;
            background: #FFCB74;
            top: -15%;
            left: -15%;
            animation: moveLiquid 35s infinite alternate ease-in-out;
        }

        .shape2 {
            width: 500px;
            height: 500px;
            background: #FFDFB9;
            bottom: -20%;
            right: -20%;
            animation: moveLiquid 30s infinite alternate-reverse ease-in-out;
        }
        
        .shape3 {
            width: 400px;
            height: 400px;
            background: #FFD39B;
            bottom: 25%;
            left: 20%;
            animation: moveLiquid 40s infinite alternate ease-in-out;
        }


        /* Main Container - Apple's Frosted Glass Effect */
        .container {
            max-width: 1200px;
            margin: 40px auto;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(50px);
            -webkit-backdrop-filter: blur(50px);
            border-radius: 32px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1), inset 0 1px 1px rgba(255, 255, 255, 0.6);
            padding: 40px;
            border: 1.5px solid rgba(255, 255, 255, 0.8);
            animation: fadeIn 0.8s ease-out;
        }

        /* Typography */
        h1 {
            color: #111111;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
            font-weight: 700;
            animation: slideDown 0.6s ease-out;
        }

        h3 {
            color: #111111;
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
            border-left: 4px solid #FFCB74;
            padding-left: 12px;
            animation: slideInLeft 0.7s ease-out;
        }

        /* Input & Textarea */
        .input-section {
            margin-bottom: 35px;
        }

        textarea {
            width: 100%;
            height: 200px;
            padding: 18px;
            border: 1px solid rgba(47, 47, 47, 0.1);
            border-radius: 16px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            background: rgba(246, 246, 246, 0.5);
            color: #111111;
            transition: all 0.3s ease;
            resize: vertical;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }

        textarea:focus {
            outline: none;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05), 0 0 0 3px rgba(255, 203, 116, 0.5);
            background: #fff;
        }

        /* Custom Inputs */
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: #2F2F2F;
        }

        input[type="number"] {
            padding: 12px 16px;
            border: 1px solid rgba(47, 47, 47, 0.1);
            border-radius: 12px;
            font-size: 14px;
            width: 180px;
            background: rgba(246, 246, 246, 0.5);
            color: #111111;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        
        input[type="number"]:focus {
             outline: none;
             box-shadow: inset 0 2px 4px rgba(0,0,0,0.05), 0 0 0 3px rgba(255, 203, 116, 0.5);
             background: #fff;
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 40px 0;
            animation: fadeInUp 0.8s ease-out;
        }

        button {
            padding: 14px 32px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            letter-spacing: 0.5px;
        }

        button:hover {
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
            filter: brightness(0.95);
        }
        
        button[onclick="processData()"] {
            background: #2F2F2F;
            color: #FFCB74;
            box-shadow: 0 6px 20px rgba(47, 47, 47, 0.3);
        }
        button[onclick="processData()"]:hover {
            box-shadow: 0 8px 25px rgba(47, 47, 47, 0.4);
        }

        button.secondary-button {
            background: rgba(47, 47, 47, 0.1);
            color: #2F2F2F;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        button.secondary-button:hover {
            background: rgba(47, 47, 47, 0.15);
        }

        /* Chi tiết cống selection */
        .chi-tiet-section {
            background: rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.4);
            padding: 25px;
            border-radius: 24px;
            margin: 35px 0;
        }

        .chi-tiet-all-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 16px;
        }

        .chi-tiet-all-selector select, .chi-tiet-item select {
            padding: 10px 14px;
            border: 1px solid rgba(47, 47, 47, 0.1);
            border-radius: 12px;
            background: rgba(246, 246, 246, 0.5);
            color: #111111;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .chi-tiet-all-selector select:focus, .chi-tiet-item select:focus {
            outline: none;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05), 0 0 0 3px rgba(255, 203, 116, 0.5);
        }

        .chi-tiet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .chi-tiet-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            transition: all 0.3s ease;
        }
        
        .chi-tiet-item:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.5);
        }

        .chi-tiet-item label {
            margin: 0;
            font-weight: 600;
            color: #111111;
            min-width: 120px;
        }

        /* Output & Table */
        .output-section {
            margin-top: 40px;
        }

        .table-container {
            overflow: auto;
            max-height: 500px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            min-width: 1200px;
        }

        th {
            padding: 18px 16px;
            text-align: left;
            border: none;
            border-bottom: 2px solid #FFCB74;
            background: rgba(255, 223, 185, 0.2);
            color: #111111;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            font-size: 13px;
            position: sticky;
            top: 0;
            z-index: 10;
            backdrop-filter: blur(20px);
        }

        td {
            padding: 16px;
            text-align: left;
            border: none;
            border-bottom: 1px solid rgba(47, 47, 47, 0.1);
            background: transparent;
            transition: background-color 0.2s ease-out;
        }
        
        tr {
            animation: fadeInRow 0.5s ease-out forwards;
            opacity: 0;
        }

        tr:hover td {
            background: rgba(255, 203, 116, 0.15);
        }

        .changed-row td {
            background: rgba(255, 203, 116, 0.1) !important;
            border-left: 4px solid #FFCB74;
            font-weight: 500;
        }

        /* Scrollbar */
        .table-container::-webkit-scrollbar { height: 10px; width: 10px; }
        .table-container::-webkit-scrollbar-track { background: transparent; }
        .table-container::-webkit-scrollbar-thumb { background: rgba(47, 47, 47, 0.4); border-radius: 5px; border: 2px solid transparent; background-clip: content-box;}
        .table-container::-webkit-scrollbar-thumb:hover { background: #2F2F2F; }

        /* Modal Styling */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000; padding: 15px; opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .modal-overlay.visible { opacity: 1; visibility: visible; }

        .modal-content {
            background: rgba(246, 246, 246, 0.8);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            padding: 30px 40px; border-radius: 24px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 90%; max-width: 600px; text-align: center;
            transform: scale(0.95); transition: transform 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        
        .modal-overlay.visible .modal-content { transform: scale(1); }
        .modal-content h3 { color: #111111; margin-bottom: 15px; border: none; padding-left: 0; }
        .modal-content p { margin-bottom: 20px; line-height: 1.6; color: #2F2F2F; }
        .modal-content p strong { color: #111111; font-weight: 600; }
        .modal-input-group { margin-bottom: 25px; }
        .modal-input-group label { display: block; margin-bottom: 8px; font-weight: 500; text-align: left; }
        .modal-input-group input { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid rgba(47, 47, 47, 0.1); font-size: 1rem; background: rgba(255, 255, 255, 0.7); box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); }
        .modal-input-group input:focus { outline: none; border-color: #FFCB74; box-shadow: 0 0 0 3px rgba(255, 203, 116, 0.5); }
        .modal-button-group { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        .modal-button-group button { flex-grow: 1; padding: 12px; border: none; border-radius: 50px; cursor: pointer; font-weight: 600; transition: all 0.2s ease; min-width: 120px; }
        #modalUpdateBtn, #confirmYesBtn, #insufficientDataContinueBtn { background: #2F2F2F; color: #FFCB74; }
        #modalRemoveBtn { background: #A4193D; color: #fff; }
        #modalCancelBtn, #alertOkBtn, #confirmNoBtn, #insufficientDataEditBtn { background: #b0b0b0; color: #fff; }
        
        /* Keyframes */
        @keyframes moveLiquid {
            from { transform: translate(0, 0) rotate(0deg) scale(1); }
            to { transform: translate(100px, -100px) rotate(180deg) scale(1.2); }
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideInLeft { from { opacity: 0; transform: translateX(-30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInRow { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>
    <div class="liquid-background">
        <div class="shape shape1"></div>
        <div class="shape shape2"></div>
        <div class="shape shape3"></div>
    </div>
    <div class="container">
        <h1>📊 LEDAT - XỬ LÝ DỮ LIỆU VẼ TRẮC DỌC CỐNG</h1>

        <div class="input-section">
            <h3>⚙️ Thông số tính toán:</h3>
            <div style="display: flex; gap: 20px; margin-bottom: 15px; flex-wrap: wrap;">
                <div>
                    <label for="mocBanDau">Mốc lý trình ban đầu (m):</label>
                    <input type="number" id="mocBanDau" placeholder="Ví dụ: 0 hoặc 1234" value="0">
                </div>
                <div>
                    <label for="beRongLong">Bề rộng bên trong lòng cống (m):</label>
                    <input type="number" id="beRongLong" placeholder="Ví dụ: 1.0" value="1.0" step="0.1">
                </div>
            </div>
        </div>

        <div class="input-section">
            <h3>📝 Dữ liệu đầu vào:</h3>
            <textarea id="inputData" placeholder="Dán dữ liệu Excel của bạn vào đây..." oninput="updateChiTietOptions()"></textarea>
        </div>

        <div class="chi-tiet-section" id="chiTietSection" style="display: none;">
            <h3 id="chiTietTitle">🎯 Chi tiết cống cho từng Giếng thu:</h3>
            <p style="margin-bottom: 15px; color: #A4193D;">Chọn loại chi tiết cống (VH, H10, H30) cho mỗi giếng thu. Giá trị này sẽ được kết hợp với kích thước cống để tạo chi tiết cống.</p>

            <div class="chi-tiet-all-selector">
                <label for="selectAllChiTiet"><strong>Chọn nhanh cho tất cả:</strong></label>
                <select id="selectAllChiTiet" onchange="applyToAllChiTiet(this.value)">
                    <option value="">-- Chọn --</option>
                    <option value="VH">VH</option>
                    <option value="H10">H10</option>
                    <option value="H30">H30</option>
                </select>
            </div>

            <div class="chi-tiet-grid" id="chiTietGrid">
            </div>
        </div>

        <div class="button-group">
            <button onclick="processData()">🚀 Xử lý dữ liệu</button>
            <button class="secondary-button" onclick="copyResult()">📋 Sao chép kết quả</button>
            <button class="secondary-button" onclick="clearData()">🗑️ Xóa dữ liệu</button>
            <button class="secondary-button" onclick="downloadCSV()">💾 Tải CSV</button>
            <button class="secondary-button" onclick="downloadLisp()">📄 Tải file LISP mới nhất</button>
        </div>

        <div class="output-section" id="outputSection" style="display: none;">
            <h3>📈 Kết quả:</h3>
            <div class="table-container">
                <div id="result"></div>
            </div>
            <textarea id="outputData" style="display:none;"></textarea>
        </div>
    </div>

    <!-- Modals -->
    <div id="zeroLengthModal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="modalTitle">⚠️ Cảnh báo dữ liệu</h3>
            <p id="modalMessage">Phát hiện lỗi...</p>
            <div class="modal-input-group">
                <label for="newLengthValue">Nhập chiều dài cống mới (m):</label>
                <input type="number" id="newLengthValue" placeholder="Ví dụ: 63.6">
            </div>
            <div class="modal-button-group">
                <button id="modalUpdateBtn">Cập nhật</button>
                <button id="modalRemoveBtn">Xóa Giếng thu này</button>
                <button id="modalCancelBtn">Hủy bỏ</button>
            </div>
        </div>
    </div>
    
    <div id="insufficientDataModal" class="modal-overlay">
        <div class="modal-content">
            <h3>⚠️ Cảnh báo dữ liệu không đầy đủ</h3>
            <p id="insufficientDataMessage" style="text-align: left; line-height: 1.6;"></p>
            <p style="margin-top: 15px;">Bạn có muốn tiếp tục xử lý và để trống các ô bị thiếu, hay dừng lại để sửa dữ liệu thô?</p>
            <div class="modal-button-group">
                <button id="insufficientDataContinueBtn">Tiếp tục xử lý</button>
                <button id="insufficientDataEditBtn">Dừng lại để sửa</button>
            </div>
        </div>
    </div>

    <div id="alertModal" class="modal-overlay">
        <div class="modal-content">
             <p id="alertMessage" style="margin-bottom: 25px;">Nội dung thông báo.</p>
             <div class="modal-button-group">
                  <button id="alertOkBtn">OK</button>
             </div>
        </div>
    </div>

    <div id="confirmModal" class="modal-overlay">
        <div class="modal-content">
            <p id="confirmMessage" style="margin-bottom: 25px;">Bạn có chắc chắn?</p>
            <div class="modal-button-group">
                <button id="confirmYesBtn">Có</button>
                <button id="confirmNoBtn">Không</button>
            </div>
        </div>
    </div>


    <script>
        const _0x4fadea=_0x5236;(function(_0x36527a,_0x389b7a){const _0x47642e=_0x5236,_0x83290d=_0x36527a();while(!![]){try{const _0x29aa64=-parseInt(_0x47642e(0x10f))/0x1+-parseInt(_0x47642e(0xe9))/0x2*(-parseInt(_0x47642e(0x147))/0x3)+parseInt(_0x47642e(0x12c))/0x4*(parseInt(_0x47642e(0x154))/0x5)+parseInt(_0x47642e(0x116))/0x6+parseInt(_0x47642e(0x128))/0x7+-parseInt(_0x47642e(0xde))/0x8*(-parseInt(_0x47642e(0xed))/0x9)+-parseInt(_0x47642e(0xfe))/0xa;if(_0x29aa64===_0x389b7a)break;else _0x83290d['push'](_0x83290d['shift']());}catch(_0x57d246){_0x83290d['push'](_0x83290d['shift']());}}}(_0x2238,0xbd44d));let processedData=[],uniqueTenGts=[],chiTietCongMap={},pipeTypeMap={},zeroLengthEntriesQueue=[],currentInvalidEntry=null;function showModal(_0x25e134){const _0x45b04f=_0x5236,_0x3706ff=document[_0x45b04f(0x11e)](_0x25e134);_0x3706ff&&_0x3706ff['classList'][_0x45b04f(0x103)]('visible');}function _0x5236(_0x5265ea,_0x373a){const _0x2238c5=_0x2238();return _0x5236=function(_0x523674,_0xf1ec73){_0x523674=_0x523674-0xce;let _0x4072b4=_0x2238c5[_0x523674];return _0x4072b4;},_0x5236(_0x5265ea,_0x373a);}function hideModal(_0x52758c){const _0x5063d5=_0x5236,_0x44a92a=document['getElementById'](_0x52758c);_0x44a92a&&_0x44a92a['classList'][_0x5063d5(0x104)](_0x5063d5(0xd8));}function showCustomAlert(_0x409134,_0x3dd88c='info'){const _0x47daf7=_0x5236,_0x162d2f=document[_0x47daf7(0x11e)](_0x47daf7(0x139));let _0x4a75cc='✅';if(_0x3dd88c===_0x47daf7(0xf3))_0x4a75cc='⚠️';_0x162d2f[_0x47daf7(0xfa)]=_0x4a75cc+'\x20'+_0x409134,showModal('alertModal'),document[_0x47daf7(0x11e)](_0x47daf7(0xcf))[_0x47daf7(0xea)]=()=>hideModal(_0x47daf7(0xf9));}function showCustomConfirm(_0x55bd18,_0x1d172d,_0x428d03){const _0x824a5=_0x5236,_0x532b8a=document[_0x824a5(0x11e)](_0x824a5(0x143)),_0x2edaf5=document['getElementById']('confirmYesBtn'),_0x2de2a8=document[_0x824a5(0x11e)](_0x824a5(0xe6));_0x532b8a[_0x824a5(0xfa)]=_0x55bd18,showModal(_0x824a5(0x144)),_0x2edaf5[_0x824a5(0xea)]=()=>{const _0x1054b0=_0x824a5;hideModal(_0x1054b0(0x144));if(_0x1d172d)_0x1d172d();},_0x2de2a8[_0x824a5(0xea)]=()=>{const _0x372bc2=_0x824a5;hideModal(_0x372bc2(0x144));if(_0x428d03)_0x428d03();};}function parseInputIntoBlocks(_0x43c9a5){const _0x12311a=_0x5236,_0x4de05a=[];let _0x4356c9=null;return _0x43c9a5[_0x12311a(0x138)](_0x387012=>{const _0x12cc17=_0x12311a;if(_0x387012[_0x12cc17(0x12d)]()==='')return;const _0x378160=_0x387012[_0x12cc17(0x15a)](/\t|\s{2,}/)['map'](_0x2af7e3=>_0x2af7e3[_0x12cc17(0x12d)]()),_0x56eebe=_0x378160[0x0];if(_0x56eebe&&/^[A-Z0-9-]+$/['test'](_0x56eebe))_0x4356c9&&_0x4de05a[_0x12cc17(0xce)](_0x4356c9),_0x4356c9={'tenGt':_0x56eebe,'dataLines':[_0x387012],'infoLine':null,'allLinesInBlock':[_0x387012]};else _0x4356c9&&(_0x4356c9[_0x12cc17(0x11f)][_0x12cc17(0xce)](_0x387012),_0x378160[0x0]===''&&_0x378160[_0x12cc17(0x11c)]>0x1&&(_0x378160[_0x12cc17(0x122)](_0x9c32ce=>_0x9c32ce['startsWith']('Þ'))||_0x378160['some'](_0x2d0818=>_0x2d0818[_0x12cc17(0xec)]()[_0x12cc17(0x114)]('HV')))?_0x4356c9[_0x12cc17(0xd3)]=_0x387012:_0x4356c9[_0x12cc17(0xe3)]['push'](_0x387012));}),_0x4356c9&&_0x4de05a['push'](_0x4356c9),_0x4de05a;}function _0x2238(){const _0x3c94a8=['selectAllChiTiet','confirmMessage','confirmModal','chiTietGrid','tron','3321DFlBte','get','Tất\x20cả\x20lỗi\x20đã\x20được\x20sửa.\x20Đang\x20xử\x20lý\x20lại\x20dữ\x20liệu...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chi-tiet-item\x22\x20style=\x22animation:\x20fadeInUp\x200.5s\x20ease-out\x20','#zeroLengthModal\x20#newLengthValue','</th>','Vui\x20lòng\x20nhập\x20một\x20giá\x20trị\x20chiều\x20dài\x20hợp\x20lệ\x20(lớn\x20hơn\x200).','\x22\x20onchange=\x22updateChiTietCong(\x27','H10','focus','createElement','map','Quá\x20trình\x20xử\x20lý\x20đã\x20được\x20hủy\x20bỏ.','20fqMpkz','Đã\x20tải\x20file\x20','setAttribute','đáy\x20móng\x20giếng\x20thu','H30','>VH</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22H10\x22\x20','split','insufficientDataMessage','querySelector','value','toString','Bạn\x20có\x20chắc\x20chắn\x20muốn\x20xóa\x20tất\x20cả\x20dữ\x20liệu\x20của\x20Giếng\x20thu\x20<strong>','block','download','zeroLengthModal','day_dong_chay','Vui\x20lòng\x20nhập\x20dữ\x20liệu','push','alertOkBtn','getDate','\x27,\x20this.value)\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22\x22>--\x20Chọn\x20--</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22VH\x22\x20','🎯\x20Chi\x20tiết\x20các\x20loại\x20cống\x20tròn:','infoLine','đáy\x20dòng\x20chảy','đàn\x20giếng\x20thu','đáy\x20móng\x20cống','day_ho_lang','visible','style','insufficientDataEditBtn','match','chieu_dai_cong_m','\x20thành\x20công!','1688wmnSDI','insufficientDataContinueBtn','mat_dat_tu_nhien','</strong>.','Chưa\x20có\x20dữ\x20liệu\x20để\x20tải.\x20Vui\x20lòng\x20xử\x20lý\x20dữ\x20liệu\x20trước.','dataLines','appendChild','click','confirmNoBtn','padStart','ten_gt','758NcRhpW','onclick','select-','toUpperCase','42768sGDcdO','data-','chiTietTitle','hop','day_mong_cong','isHeader','error','<table><thead><tr>','.csv','N/A','</tr></thead><tbody>','Chưa\x20có\x20dữ\x20liệu\x20để\x20sao\x20chép.\x20Vui\x20lòng\x20xử\x20lý\x20dữ\x20liệu\x20trước.','alertModal','innerHTML','chi_tiet_cong','Đã\x20sao\x20chép\x20dữ\x20liệu\x20vào\x20clipboard!','changed-row','14110820yrGeGx','ly_trinh','isChanged','shift','beRongLong','add','remove','</strong>\x20cột\x20dữ\x20liệu.\x20Cần\x20cung\x20cấp\x20đủ\x20giá\x20trị\x20cho\x20các\x20cột\x20sau:\x20<strong>','result','find','>H30</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ms\x20forwards;\x20opacity:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22select-','Cột\x20<strong>chieu_dai_cong_m</strong>\x20của\x20Giếng\x20thu\x20<strong>','outputData','</tbody></table>','cells','filter','789862ntsWlj','slice','newLengthValue','outputSection','join','startsWith','copy','4443846iSXReG','display','</strong>\x20không?','getMonth','findIndex','loai_cong','length','lưng\x20cống','getElementById','allLinesInBlock','fill','has','some','select','selected','hidden','insufficientDataModal','none','4578805MjABjc','https://drive.google.com/drive/folders/146q8ahmOwP8Gzwq647zoGoKNbJ3c7y4d?usp=drive_link','createObjectURL','đáy\x20hố\x20lắng','159208UoAeUV','trim','modalRemoveBtn','tenGt','round','modalUpdateBtn','_blank','visibility','replace','text/csv;charset=utf-8;','<th>','getFullYear','forEach','alertMessage','</tr>','chiTietSection','href','body','<tr\x20class=\x22','ms\x22>','lung_cong','inputData'];_0x2238=function(){return _0x3c94a8;};return _0x2238();}function processLoaiCongCell(_0x2e8516){const _0x530426=_0x5236;if(!_0x2e8516)return'';const _0x4006d8=/^HV\s*[\d,.]+\s*x\s*([\d,.]+)$/i;let _0x9e0a38=_0x2e8516[_0x530426(0xdb)](_0x4006d8);if(_0x9e0a38){const _0x2200a5=_0x9e0a38[0x1][_0x530426(0x134)](',','.'),_0xa9e76c=parseFloat(_0x2200a5);return!isNaN(_0xa9e76c)?(_0xa9e76c*0x3e8)[_0x530426(0x15e)]():_0x2e8516;}const _0x2a2029=/^Þ(\d+)$/;_0x9e0a38=_0x2e8516['match'](_0x2a2029);if(_0x9e0a38){const _0x5c14f3=_0x9e0a38[0x1];return _0x5c14f3+'0';}return _0x2e8516;}function updateChiTietOptions(){const _0x190dd5=_0x5236,_0x375181=document[_0x190dd5(0x11e)](_0x190dd5(0x141))[_0x190dd5(0x15d)][_0x190dd5(0x12d)](),_0x49e09f=document[_0x190dd5(0x11e)](_0x190dd5(0x13b)),_0x2f35d2=document['getElementById'](_0x190dd5(0x145)),_0x444104=document[_0x190dd5(0x11e)](_0x190dd5(0xef));document[_0x190dd5(0x11e)](_0x190dd5(0x142))[_0x190dd5(0x15d)]='';if(!_0x375181){_0x49e09f[_0x190dd5(0xd9)][_0x190dd5(0x117)]=_0x190dd5(0x127);return;}const _0x4786be=_0x375181[_0x190dd5(0x15a)]('\x0a'),_0x1a910a=parseInputIntoBlocks(_0x4786be);uniqueTenGts=_0x1a910a[_0x190dd5(0x152)](_0x24b280=>_0x24b280['tenGt']);const _0x54b222={};let _0x11ca69=null;_0x1a910a[_0x190dd5(0x138)](_0x2f40df=>{const _0x1845af=_0x190dd5;if(_0x2f40df[_0x1845af(0xd3)]){const _0x31be04=_0x2f40df[_0x1845af(0xd3)]['split'](/\t|\s{2,}/)[_0x1845af(0x152)](_0x1c1ef0=>_0x1c1ef0['trim']()),_0x4a7b31=_0x31be04[_0x1845af(0x107)](_0x1d9c11=>_0x1d9c11['toUpperCase']()[_0x1845af(0x114)]('HV')||_0x1d9c11[_0x1845af(0x114)]('Þ'))||'';_0x54b222[_0x2f40df[_0x1845af(0x12f)]]=_0x4a7b31;if(!_0x11ca69){if(_0x4a7b31[_0x1845af(0xec)]()[_0x1845af(0x114)]('HV'))_0x11ca69='hop';else _0x4a7b31[_0x1845af(0x114)]('Þ')&&(_0x11ca69=_0x1845af(0x146));}}});if(_0x11ca69===_0x190dd5(0xf0))_0x444104[_0x190dd5(0xfa)]='🎯\x20Chi\x20tiết\x20các\x20loại\x20cống\x20hộp:';else _0x11ca69===_0x190dd5(0x146)?_0x444104[_0x190dd5(0xfa)]=_0x190dd5(0xd2):_0x444104[_0x190dd5(0xfa)]='🎯\x20Chi\x20tiết\x20cống\x20cho\x20từng\x20Giếng\x20thu:';if(uniqueTenGts[_0x190dd5(0x11c)]>0x0){_0x49e09f[_0x190dd5(0xd9)]['display']=_0x190dd5(0x160);let _0x54d05e='';uniqueTenGts[_0x190dd5(0x138)]((_0xad86d3,_0x202b2e)=>{const _0x104363=_0x190dd5,_0x1af627=chiTietCongMap[_0xad86d3]||'',_0x26446d=_0x54b222[_0xad86d3]||_0x104363(0xf6),_0x2001b6='\x20('+_0x26446d+')';_0x54d05e+=_0x104363(0x14a)+_0x202b2e*0x32+_0x104363(0x109)+_0xad86d3+'\x22>'+_0xad86d3+_0x2001b6+':</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22select-'+_0xad86d3+_0x104363(0x14e)+_0xad86d3+_0x104363(0xd1)+(_0x1af627==='VH'?_0x104363(0x124):'')+_0x104363(0x159)+(_0x1af627===_0x104363(0x14f)?_0x104363(0x124):'')+'>H10</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22H30\x22\x20'+(_0x1af627===_0x104363(0x158)?'selected':'')+_0x104363(0x108);}),_0x2f35d2[_0x190dd5(0xfa)]=_0x54d05e;}else _0x49e09f['style'][_0x190dd5(0x117)]=_0x190dd5(0x127);}function updateChiTietCong(_0x28853f,_0x2da8ff){const _0x3c5946=_0x5236;_0x2da8ff===''?delete chiTietCongMap[_0x28853f]:chiTietCongMap[_0x28853f]=_0x2da8ff,document[_0x3c5946(0x11e)](_0x3c5946(0x142))[_0x3c5946(0x15d)]='';}function applyToAllChiTiet(_0x24a15d){const _0x3966af=_0x5236;uniqueTenGts[_0x3966af(0x138)](_0xe73446=>{const _0x100ee2=_0x3966af;_0x24a15d===''?delete chiTietCongMap[_0xe73446]:chiTietCongMap[_0xe73446]=_0x24a15d;const _0x5792f2=document['getElementById'](_0x100ee2(0xeb)+_0xe73446);_0x5792f2&&(_0x5792f2[_0x100ee2(0x15d)]=_0x24a15d);});}function processData(){const _0x447eca=_0x5236,_0x775abb=document[_0x447eca(0x11e)](_0x447eca(0x141))['value']['trim']();if(!_0x775abb){showCustomAlert(_0x447eca(0x164),_0x447eca(0xf3));return;}runInsufficientDataValidation();}function runInsufficientDataValidation(){const _0x398570=_0x5236,_0x1960b8=document[_0x398570(0x11e)](_0x398570(0x141))['value'][_0x398570(0x12d)]()[_0x398570(0x15a)]('\x0a'),_0x352812=parseInputIntoBlocks(_0x1960b8);let _0x460a69=null;const _0x5115e9=0x7,_0x1774b0=['mặt\x20đất\x20tự\x20nhiên',_0x398570(0xd5),_0x398570(0x11d),_0x398570(0xd4),_0x398570(0x12b),_0x398570(0x157),_0x398570(0xd6)];for(const _0x3f3fb1 of _0x352812){let _0x3dcd50=![];if(_0x3f3fb1[_0x398570(0xd3)]){const _0x28d935=_0x3f3fb1[_0x398570(0xd3)][_0x398570(0x15a)](/\t|\s{2,}/)[_0x398570(0x152)](_0x4e7a75=>_0x4e7a75['trim']()[_0x398570(0x134)](',','.')),_0x6e9e74=_0x28d935[_0x398570(0x11a)](_0xc0dcb3=>_0xc0dcb3[_0x398570(0x114)]('Þ')||_0xc0dcb3[_0x398570(0xec)]()[_0x398570(0x114)]('HV'));if(_0x6e9e74!==-0x1)for(let _0x5f1498=_0x6e9e74+0x1;_0x5f1498<_0x28d935['length'];_0x5f1498++){if(_0x28d935[_0x5f1498]!==''&&parseFloat(_0x28d935[_0x5f1498])===0x0){_0x3dcd50=!![];break;}}}if(_0x3dcd50)continue;for(const _0x1b11e4 of _0x3f3fb1[_0x398570(0xe3)]){const _0x19c82c=_0x1b11e4[_0x398570(0x15a)](/\t|\s{2,}/)['map'](_0x1c2490=>_0x1c2490[_0x398570(0x12d)]())[_0x398570(0x10e)](_0xb3581=>_0xb3581!=='');let _0x32caf9=0x0,_0x35fd1d=![];for(const _0x2c94a3 of _0x19c82c){!isNaN(parseFloat(_0x2c94a3[_0x398570(0x134)](',','.')))&&(_0x35fd1d=!![]),_0x35fd1d&&_0x32caf9++;}if(_0x35fd1d&&_0x32caf9<_0x5115e9){const _0x1162cf=_0x5115e9-_0x32caf9,_0x51325e=_0x1774b0[_0x398570(0x110)](_0x32caf9);_0x460a69={'missingCount':_0x1162cf,'missingCols':_0x51325e};break;}}if(_0x460a69)break;}_0x460a69?handleInsufficientData(_0x460a69):runZeroLengthValidation();}function runZeroLengthValidation(){const _0x26fa44=_0x5236,_0x382871=document[_0x26fa44(0x11e)]('inputData')[_0x26fa44(0x15d)]['trim']()[_0x26fa44(0x15a)]('\x0a'),_0x26081d=parseInputIntoBlocks(_0x382871),_0x87cf8a=[];_0x26081d[_0x26fa44(0x138)](_0x2ff039=>{const _0x337606=_0x26fa44;if(!_0x2ff039['infoLine'])return;const _0x273617=_0x2ff039[_0x337606(0xd3)][_0x337606(0x15a)](/\t|\s{2,}/)['map'](_0x5425f2=>_0x5425f2[_0x337606(0x12d)]()['replace'](',','.'));let _0x4b091b='';const _0x302fd8=_0x273617[_0x337606(0x11a)](_0x2794f8=>_0x2794f8[_0x337606(0x114)]('Þ')||_0x2794f8['toUpperCase']()['startsWith']('HV'));if(_0x302fd8!==-0x1)for(let _0x38d23f=_0x302fd8+0x1;_0x38d23f<_0x273617['length'];_0x38d23f++){if(_0x273617[_0x38d23f]!==''&&!isNaN(parseFloat(_0x273617[_0x38d23f]))){_0x4b091b=_0x273617[_0x38d23f];break;}}parseFloat(_0x4b091b)===0x0&&_0x87cf8a[_0x337606(0xce)]({'tenGt':_0x2ff039[_0x337606(0x12f)],'infoLine':_0x2ff039[_0x337606(0xd3)],'allLinesInBlock':_0x2ff039['allLinesInBlock']});}),_0x87cf8a[_0x26fa44(0x11c)]>0x0?handleZeroLengthEntries(_0x87cf8a):runProcessingLogic();}function runProcessingLogic(){const _0xcf14d5=_0x5236,_0x26ff49=document[_0xcf14d5(0x11e)]('inputData')[_0xcf14d5(0x15d)]['trim'](),_0x43795a=parseFloat(document[_0xcf14d5(0x11e)]('mocBanDau')['value'])||0x0,_0x49032b=parseFloat(document[_0xcf14d5(0x11e)](_0xcf14d5(0x102))[_0xcf14d5(0x15d)])||0x1,_0x27b527=_0x26ff49[_0xcf14d5(0x15a)]('\x0a'),_0x7bf466=parseInputIntoBlocks(_0x27b527);for(let _0x29a6c9=0x1;_0x29a6c9<_0x7bf466[_0xcf14d5(0x11c)];_0x29a6c9++){!_0x7bf466[_0x29a6c9]['infoLine']&&_0x7bf466[_0x29a6c9-0x1]['infoLine']&&(_0x7bf466[_0x29a6c9][_0xcf14d5(0xd3)]=_0x7bf466[_0x29a6c9-0x1][_0xcf14d5(0xd3)]);}processedData=[],pipeTypeMap={};const _0x5ec903=['ten_gt','loai_cong',_0xcf14d5(0xdc),_0xcf14d5(0xe0),'dan_gieng_thu',_0xcf14d5(0x140),_0xcf14d5(0x163),_0xcf14d5(0xd7),'day_mong_gieng_thu',_0xcf14d5(0xf1),_0xcf14d5(0xff),_0xcf14d5(0xfb)];processedData[_0xcf14d5(0xce)]({'cells':_0x5ec903,'isHeader':!![]});let _0x1a2ca9=null;_0x7bf466['forEach'](_0x4ab8bb=>{const _0x2b36af=_0xcf14d5;let _0x4d6e3c='',_0x452a14='';if(_0x4ab8bb[_0x2b36af(0xd3)]){const _0x2436c8=_0x4ab8bb[_0x2b36af(0xd3)][_0x2b36af(0x15a)](/\t|\s{2,}/)['map'](_0x7a2336=>_0x7a2336[_0x2b36af(0x12d)]()),_0x588744=_0x2436c8['findIndex'](_0x30a71a=>_0x30a71a['startsWith']('Þ')||_0x30a71a[_0x2b36af(0xec)]()[_0x2b36af(0x114)]('HV'));if(_0x588744!==-0x1){_0x4d6e3c=_0x2436c8[_0x588744];for(let _0x408ca1=_0x588744+0x1;_0x408ca1<_0x2436c8[_0x2b36af(0x11c)];_0x408ca1++){if(_0x2436c8[_0x408ca1]!==''&&!isNaN(parseFloat(_0x2436c8[_0x408ca1][_0x2b36af(0x134)](',','.')))){_0x452a14=_0x2436c8[_0x408ca1][_0x2b36af(0x134)](',','.');break;}}}}if(_0x4d6e3c[_0x2b36af(0xec)]()[_0x2b36af(0x114)]('HV'))pipeTypeMap[_0x4ab8bb[_0x2b36af(0x12f)]]=_0x2b36af(0xf0);else _0x4d6e3c[_0x2b36af(0x114)]('Þ')&&(pipeTypeMap[_0x4ab8bb[_0x2b36af(0x12f)]]=_0x2b36af(0x146));const _0x11ef62=processLoaiCongCell(_0x4d6e3c);_0x4ab8bb[_0x2b36af(0xe3)][_0x2b36af(0x138)]((_0x3cee63,_0x15fe1a)=>{const _0x4ea765=_0x2b36af,_0x2f3bfc=_0x3cee63['split'](/\t|\s{2,}/)[_0x4ea765(0x152)](_0x10ae5a=>_0x10ae5a[_0x4ea765(0x12d)]());let _0x3f28ab=-0x1;for(let _0x208e5f=0x0;_0x208e5f<_0x2f3bfc[_0x4ea765(0x11c)];_0x208e5f++){if(_0x2f3bfc[_0x208e5f]!==''&&!isNaN(parseFloat(_0x2f3bfc[_0x208e5f][_0x4ea765(0x134)](',','.')))){_0x3f28ab=_0x208e5f;break;}}if(_0x3f28ab===-0x1)return;const _0x5adaf3=new Array(_0x5ec903['length'])[_0x4ea765(0x120)]('');_0x5adaf3[0x0]=_0x4ab8bb[_0x4ea765(0x12f)],_0x5adaf3[0x2]=_0x452a14,_0x5adaf3[0x3]=(_0x2f3bfc[_0x3f28ab]||'')[_0x4ea765(0x134)](',','.'),_0x5adaf3[0x4]=(_0x2f3bfc[_0x3f28ab+0x1]||'')[_0x4ea765(0x134)](',','.'),_0x5adaf3[0x5]=(_0x2f3bfc[_0x3f28ab+0x2]||'')[_0x4ea765(0x134)](',','.'),_0x5adaf3[0x6]=(_0x2f3bfc[_0x3f28ab+0x3]||'')[_0x4ea765(0x134)](',','.'),_0x5adaf3[0x7]=(_0x2f3bfc[_0x3f28ab+0x4]||'')['replace'](',','.'),_0x5adaf3[0x8]=(_0x2f3bfc[_0x3f28ab+0x5]||'')[_0x4ea765(0x134)](',','.'),_0x5adaf3[0x9]=(_0x2f3bfc[_0x3f28ab+0x6]||'')[_0x4ea765(0x134)](',','.');if(_0x1a2ca9===null)_0x5adaf3[0x1]=_0x11ef62;else _0x15fe1a===0x0?_0x5adaf3[0x1]=_0x1a2ca9:_0x5adaf3[0x1]=_0x11ef62;processedData[_0x4ea765(0xce)]({'cells':_0x5adaf3,'isChanged':!![]});}),_0x1a2ca9=_0x11ef62;}),calculateLyTrinhAndChiTiet(_0x43795a,_0x49032b),displayResult();}function handleInsufficientData(_0x5c7e09){const _0x4db62d=_0x5236,_0x16f51b=document[_0x4db62d(0x11e)](_0x4db62d(0x15b)),_0x181bf7='Phát\x20hiện\x20thiếu\x20<strong>'+_0x5c7e09['missingCount']+_0x4db62d(0x105)+_0x5c7e09['missingCols'][_0x4db62d(0x113)](',\x20')+_0x4db62d(0xe1);_0x16f51b['innerHTML']=_0x181bf7,showModal(_0x4db62d(0x126)),document[_0x4db62d(0x11e)](_0x4db62d(0xdf))[_0x4db62d(0xea)]=()=>{const _0x3c02d6=_0x4db62d;hideModal(_0x3c02d6(0x126)),runZeroLengthValidation();},document[_0x4db62d(0x11e)](_0x4db62d(0xda))[_0x4db62d(0xea)]=()=>{hideModal('insufficientDataModal');};}function handleZeroLengthEntries(_0x42e5f1){zeroLengthEntriesQueue=[..._0x42e5f1],showNextZeroLengthEntry();}function showNextZeroLengthEntry(){const _0x5deb10=_0x5236;if(zeroLengthEntriesQueue[_0x5deb10(0x11c)]===0x0){hideModal(_0x5deb10(0x162)),showCustomAlert(_0x5deb10(0x149)),processData();return;}currentInvalidEntry=zeroLengthEntriesQueue[_0x5deb10(0x101)]();const _0x260490=document[_0x5deb10(0x15c)]('#zeroLengthModal\x20#modalMessage'),_0x44263f=document[_0x5deb10(0x15c)](_0x5deb10(0x14b));_0x260490[_0x5deb10(0xfa)]=_0x5deb10(0x10a)+currentInvalidEntry[_0x5deb10(0x12f)]+'</strong>\x20có\x20giá\x20trị\x20bằng\x200.\x20<br>Vui\x20lòng\x20cập\x20nhật\x20hoặc\x20xóa\x20bộ\x20dữ\x20liệu\x20này.',_0x44263f[_0x5deb10(0x15d)]='',showModal('zeroLengthModal'),_0x44263f[_0x5deb10(0x150)]();}document[_0x4fadea(0x11e)](_0x4fadea(0x131))[_0x4fadea(0xea)]=function(){const _0x5cf651=_0x4fadea,_0xd43ccb=document['getElementById'](_0x5cf651(0x111))[_0x5cf651(0x15d)];if(!_0xd43ccb||parseFloat(_0xd43ccb)<=0x0){showCustomAlert(_0x5cf651(0x14d),'error');return;}const _0x149221=document[_0x5cf651(0x11e)](_0x5cf651(0x141));let _0xef6b81=_0x149221[_0x5cf651(0x15d)][_0x5cf651(0x15a)]('\x0a');const _0x53b553=currentInvalidEntry[_0x5cf651(0xd3)],_0x25acd8=_0xef6b81['findIndex'](_0x280ef8=>_0x280ef8===_0x53b553);if(_0x25acd8!==-0x1){let _0x44eb51=_0xef6b81[_0x25acd8][_0x5cf651(0x15a)]('\x09'),_0x3ba306=![];const _0x2bbb73=_0x44eb51['findIndex'](_0x5859b1=>_0x5859b1[_0x5cf651(0x12d)]()['startsWith']('Þ')||_0x5859b1[_0x5cf651(0x12d)]()[_0x5cf651(0xec)]()[_0x5cf651(0x114)]('HV'));if(_0x2bbb73!==-0x1)for(let _0x20a221=_0x2bbb73+0x1;_0x20a221<_0x44eb51[_0x5cf651(0x11c)];_0x20a221++){if(_0x44eb51[_0x20a221][_0x5cf651(0x12d)]()!==''&&!isNaN(parseFloat(_0x44eb51[_0x20a221]['trim']()['replace'](',','.')))){_0x44eb51[_0x20a221]=_0xd43ccb,_0x3ba306=!![];break;}}_0x3ba306&&(_0xef6b81[_0x25acd8]=_0x44eb51[_0x5cf651(0x113)]('\x09'),_0x149221[_0x5cf651(0x15d)]=_0xef6b81[_0x5cf651(0x113)]('\x0a'));}showNextZeroLengthEntry();},document[_0x4fadea(0x11e)](_0x4fadea(0x12e))['onclick']=function(){const _0x10460c=_0x4fadea,_0x149573=_0x10460c(0x15f)+currentInvalidEntry[_0x10460c(0x12f)]+_0x10460c(0x118);showCustomConfirm(_0x149573,()=>{const _0x35da44=_0x10460c,_0x287376=document['getElementById'](_0x35da44(0x141));let _0x350e86=_0x287376[_0x35da44(0x15d)][_0x35da44(0x15a)]('\x0a');const _0xbc06e4=new Set(currentInvalidEntry[_0x35da44(0x11f)]),_0x1fafe6=_0x350e86[_0x35da44(0x10e)](_0x5c8714=>!_0xbc06e4[_0x35da44(0x121)](_0x5c8714));_0x287376[_0x35da44(0x15d)]=_0x1fafe6['join']('\x0a'),updateChiTietOptions(),showNextZeroLengthEntry();});},document[_0x4fadea(0x11e)]('modalCancelBtn')[_0x4fadea(0xea)]=function(){const _0x3971f4=_0x4fadea;hideModal(_0x3971f4(0x162)),zeroLengthEntriesQueue=[],currentInvalidEntry=null,showCustomAlert(_0x3971f4(0x153),_0x3971f4(0xf3));};function calculateLyTrinhAndChiTiet(_0x60a189,_0x3f63e5){const _0x40e3bb=_0x4fadea,_0x5230fd=new Map(),_0x436f33=[];processedData[_0x40e3bb(0x138)](_0x1bc387=>{const _0x52a363=_0x40e3bb;if(_0x1bc387[_0x52a363(0xf2)])return;const _0x4574d7=_0x1bc387[_0x52a363(0x10d)][0x0];if(!_0x4574d7)return;!_0x5230fd[_0x52a363(0x121)](_0x4574d7)&&(_0x5230fd['set'](_0x4574d7,[]),_0x436f33[_0x52a363(0xce)](_0x4574d7)),_0x5230fd[_0x52a363(0x148)](_0x4574d7)[_0x52a363(0xce)](_0x1bc387);});let _0x193e1b=_0x60a189;for(const _0x37a945 of _0x436f33){const _0x3ee8d7=_0x5230fd[_0x40e3bb(0x148)](_0x37a945);if(!_0x3ee8d7||_0x3ee8d7[_0x40e3bb(0x11c)]===0x0)continue;const _0x3f6ca3=_0x3ee8d7[_0x3ee8d7['length']-0x1],_0xe3ceb1=Math['floor'](_0x193e1b/0x3e8),_0x55a1fe=Math[_0x40e3bb(0x130)](_0x193e1b%0x3e8);_0x3f6ca3['cells'][0xa]='Km'+_0xe3ceb1+'+'+_0x55a1fe[_0x40e3bb(0x15e)]()[_0x40e3bb(0xe7)](0x3,'0');const _0x6c3d4b=pipeTypeMap[_0x37a945],_0x34d560=_0x3f6ca3[_0x40e3bb(0x10d)][0x1];_0x3f6ca3[_0x40e3bb(0x10d)][0xb]=generateChiTietCong(_0x37a945,_0x6c3d4b,_0x34d560);const _0x275e2=parseFloat(_0x3f6ca3[_0x40e3bb(0x10d)][0x2])||0x0;_0x193e1b+=_0x275e2+_0x3f63e5;}}function generateChiTietCong(_0x40f7e4,_0x19601d,_0x2ea6b5){const _0x1116d7=chiTietCongMap[_0x40f7e4];if(!_0x1116d7||!_0x2ea6b5||!_0x19601d)return'';return _0x19601d==='hop'?'CH'+_0x2ea6b5+'-'+_0x1116d7:'D'+_0x2ea6b5+'-'+_0x1116d7;}function displayResult(){const _0x1a7802=_0x4fadea,_0x36ee5a=document[_0x1a7802(0x11e)](_0x1a7802(0x106)),_0x49f8e2=document[_0x1a7802(0x11e)](_0x1a7802(0x10b)),_0x35ef14=document[_0x1a7802(0x11e)](_0x1a7802(0x112));_0x35ef14['style']['display']=_0x1a7802(0x160);let _0x46b9ea=_0x1a7802(0xf4);const _0x4e3678=[_0x1a7802(0xe8),_0x1a7802(0x11b),_0x1a7802(0xdc),'mat_dat_tu_nhien','dan_gieng_thu',_0x1a7802(0x140),_0x1a7802(0x163),'day_ho_lang','day_mong_gieng_thu',_0x1a7802(0xf1),_0x1a7802(0xff),_0x1a7802(0xfb)];_0x4e3678['forEach'](_0x35eb9b=>_0x46b9ea+=_0x1a7802(0x136)+_0x35eb9b+_0x1a7802(0x14c)),_0x46b9ea+=_0x1a7802(0xf7);let _0x3a3259='';processedData[_0x1a7802(0x138)]((_0xe6631d,_0x3ac2fa)=>{const _0x5b681b=_0x1a7802;if(_0xe6631d['isHeader']){_0x3a3259+=_0xe6631d[_0x5b681b(0x10d)][_0x5b681b(0x113)]('\x09')+'\x0a';return;}const _0x1a5f3d=_0xe6631d[_0x5b681b(0x100)]?_0x5b681b(0xfd):'';_0x46b9ea+=_0x5b681b(0x13e)+_0x1a5f3d+'\x22\x20style=\x22animation-delay:\x20'+_0x3ac2fa*0x1e+_0x5b681b(0x13f),_0xe6631d[_0x5b681b(0x10d)]['forEach'](_0x5b196d=>_0x46b9ea+='<td>'+_0x5b196d+'</td>'),_0x46b9ea+=_0x5b681b(0x13a),_0x3a3259+=_0xe6631d[_0x5b681b(0x10d)][_0x5b681b(0x113)]('\x09')+'\x0a';}),_0x46b9ea+=_0x1a7802(0x10c),_0x36ee5a[_0x1a7802(0xfa)]=_0x46b9ea,_0x49f8e2['value']=_0x3a3259[_0x1a7802(0x12d)]();}function downloadCSV(){const _0x531b0d=_0x4fadea,_0x18a72a=document[_0x531b0d(0x11e)](_0x531b0d(0x10b));if(_0x18a72a[_0x531b0d(0x15d)]===''){showCustomAlert(_0x531b0d(0xe2),_0x531b0d(0xf3));return;}const _0x3e0d32=new Date(),_0x1e58cf=_0x3e0d32[_0x531b0d(0xd0)]()[_0x531b0d(0x15e)]()[_0x531b0d(0xe7)](0x2,'0'),_0xe6e24a=(_0x3e0d32[_0x531b0d(0x119)]()+0x1)['toString']()[_0x531b0d(0xe7)](0x2,'0'),_0x206478=_0x3e0d32[_0x531b0d(0x137)]()[_0x531b0d(0x15e)](),_0x2adc57=_0x531b0d(0xee)+_0x1e58cf+_0xe6e24a+_0x206478+_0x531b0d(0xf5),_0x590a71=_0x18a72a[_0x531b0d(0x15d)][_0x531b0d(0x15a)]('\x0a')[_0x531b0d(0x152)](_0x564866=>_0x564866[_0x531b0d(0x15a)]('\x09')[_0x531b0d(0x113)](','))[_0x531b0d(0x113)]('\x0a'),_0x430e8c=new Blob(['\ufeff'+_0x590a71],{'type':_0x531b0d(0x135)}),_0x24799a=document[_0x531b0d(0x151)]('a');if(_0x24799a[_0x531b0d(0x161)]!==undefined){const _0x2d8fac=URL[_0x531b0d(0x12a)](_0x430e8c);_0x24799a[_0x531b0d(0x156)](_0x531b0d(0x13c),_0x2d8fac),_0x24799a[_0x531b0d(0x156)]('download',_0x2adc57),_0x24799a['style'][_0x531b0d(0x133)]=_0x531b0d(0x125),document['body'][_0x531b0d(0xe4)](_0x24799a),_0x24799a[_0x531b0d(0xe5)](),document[_0x531b0d(0x13d)]['removeChild'](_0x24799a),URL['revokeObjectURL'](_0x2d8fac),showCustomAlert(_0x531b0d(0x155)+_0x2adc57+_0x531b0d(0xdd));}}function copyResult(){const _0x383b54=_0x4fadea,_0x36cf2a=document['getElementById'](_0x383b54(0x10b));if(_0x36cf2a['value']===''){showCustomAlert(_0x383b54(0xf8),_0x383b54(0xf3));return;}_0x36cf2a['style']['display']=_0x383b54(0x160),_0x36cf2a[_0x383b54(0x123)](),document['execCommand'](_0x383b54(0x115)),_0x36cf2a[_0x383b54(0xd9)]['display']=_0x383b54(0x127),showCustomAlert(_0x383b54(0xfc));}function clearData(){const _0x48b728=_0x4fadea;document[_0x48b728(0x11e)](_0x48b728(0x141))[_0x48b728(0x15d)]='',document[_0x48b728(0x11e)](_0x48b728(0x106))[_0x48b728(0xfa)]='',document[_0x48b728(0x11e)]('outputData')[_0x48b728(0x15d)]='',document[_0x48b728(0x11e)](_0x48b728(0x112))['style']['display']='none',document['getElementById'](_0x48b728(0x13b))['style'][_0x48b728(0x117)]=_0x48b728(0x127),processedData=[],uniqueTenGts=[],chiTietCongMap={},pipeTypeMap={};}function downloadLisp(){const _0x1cde47=_0x4fadea,_0x1045aa=_0x1cde47(0x129);window['open'](_0x1045aa,_0x1cde47(0x132)),showCustomAlert('Đã\x20điều\x20hướng\x20đến\x20thư\x20mục\x20chứa\x20file\x20LISP\x20mới\x20nhất!');}
    </script>
</body>
</html>
