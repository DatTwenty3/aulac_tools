<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng c·ª• t√≠nh kh√°i to√°n ƒê∆∞·ªùng - C·∫ßu</title>
    <style>
        /* --- Thi·∫øt L·∫≠p C∆° B·∫£n & Font Ch·ªØ --- */
        :root {
            --primary-color: #111111;
            --secondary-color: #2F2F2F;
            --accent-color: #FFCB74;
            --accent-color-light: rgba(255, 203, 116, 0.5);
            --accent-color-dark: #D4A03C;
            --bg-color-light: rgba(255, 255, 255, 0.7);
            --bg-glass: rgba(246, 246, 246, 0.6);
            --border-color: rgba(47, 47, 47, 0.1);
            --success-color: #34c759;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(-45deg, #a1c4fd, #c2e9fb, #ff9a9e, #fad0c4);
            background-size: 400% 400%;
            animation: gradientAnimation 15s ease infinite;
            color: var(--primary-color);
            min-height: 100vh;
            padding: 2rem;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: var(--bg-glass);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border-radius: 30px;
            border: 1px solid rgba(246, 246, 246, 0.8);
            box-shadow: 0 16px 40px rgba(47, 47, 47, 0.1);
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }

        .header {
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--primary-color);
        }
        
        .header p {
            font-size: 1.1em;
            color: var(--secondary-color);
            opacity: 0.9;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            padding: 10px 30px 30px 30px;
        }

        .section {
            padding: 20px 0;
        }
        
        .section-title {
            font-size: 1.5em;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent-color);
        }

        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--secondary-color);
            font-size: 1em;
        }
        
        .input-group input {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 1em;
            background: var(--bg-color-light);
            color: var(--primary-color);
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
        }
        
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none; margin: 0;
        }
        input[type=number] { -moz-appearance: textfield; }
        
        .input-group input::placeholder { color: rgba(47, 47, 47, 0.4); }
        
        .input-group input:focus {
            outline: none;
            background: white;
            box-shadow: 0 0 0 4px var(--accent-color-light);
            border-color: var(--accent-color);
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
            padding: 5px;
        }

        .option-card {
            display: block;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.25s ease-in-out;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px rgba(47, 47, 47, 0.05);
        }

        .option-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(47, 47, 47, 0.1);
        }
        
        .option-card.selected {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px var(--accent-color-light);
            background: white;
        }

        .option-card p { margin: 0 0 8px 0; font-size: 0.9em; line-height: 1.5; color: var(--secondary-color); }
        .option-card p:last-child { margin-bottom: 0; }
        .option-card strong { color: var(--primary-color); }
        .option-card .cost { font-weight: bold; color: var(--accent-color-dark); }
        .option-card input[type="radio"] { display: none; }

        .results-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .result-item {
            background: rgba(255, 255, 255, 0.5);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(47, 47, 47, 0.05);
        }
        
        .result-item strong { display: block; margin-bottom: 8px; font-size: 1em; font-weight: 500; color: var(--secondary-color); opacity: 0.8; }
        
        .result-value {
            font-size: 1.8em;
            font-weight: 700;
            color: var(--primary-color);
            word-wrap: break-word;
            transition: color 0.3s ease;
        }
        
        .unit { font-size: 1em; opacity: 0.7; margin-left: 8px; color: var(--secondary-color); }
        
        .value-updated {
            color: var(--success-color) !important;
            transition: color 0.1s ease-in-out;
        }
        
        .error-message {
            padding: 15px;
            background-color: #ffdddd;
            border-left: 6px solid #f44336;
            margin: 20px;
            border-radius: 8px;
            display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
        }

        @media (max-width: 768px) {
            body { padding: 1rem; }
            .header h1 { font-size: 2em; }
            .header p { font-size: 1em; }
            .content { padding: 15px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ£Ô∏è C√¥ng c·ª• t√≠nh kh√°i to√°n</h1>
            <p>C√¥ng c·ª• t√≠nh to√°n t·ª± ƒë·ªông c√°c th√¥ng s·ªë v√† chi ph√≠ k·ªπ thu·∫≠t</p>
        </div>

        <div id="errorMessage" class="error-message"></div>
        
        <div class="content">
            <!-- TH√îNG S·ªê H√åNH H·ªåC -->
            <div class="section">
                <h2 class="section-title">Th√¥ng S·ªë H√¨nh H·ªçc</h2>
                <div class="input-group">
                    <label for="roadLength">Chi·ªÅu d√†i tuy·∫øn ƒë∆∞·ªùng :</label>
                    <input type="number" id="roadLength" placeholder="Nh·∫≠p chi·ªÅu d√†i (m)" step="0.01">
                </div>
                 <div class="input-group">
                    <label for="bridgeLength">Chi·ªÅu d√†i c·∫ßu :</label>
                    <input type="number" id="bridgeLength" placeholder="Nh·∫≠p chi·ªÅu d√†i (m)" step="0.01">
                </div>
                <div class="input-group">
                    <label for="roadWidth">Chi·ªÅu r·ªông m·∫∑t ƒë∆∞·ªùng :</label>
                    <input type="number" id="roadWidth" placeholder="Nh·∫≠p chi·ªÅu r·ªông (m)" step="0.01">
                </div>
                <div class="input-group">
                    <label for="shoulderWidth">Chi·ªÅu r·ªông l·ªÅ gia c·ªë :</label>
                    <input type="number" id="shoulderWidth" placeholder="Nh·∫≠p chi·ªÅu r·ªông (m)" step="0.01">
                </div>
                <div class="input-group">
                    <label for="medianWidth">Chi·ªÅu r·ªông d·∫£i ph√¢n c√°ch :</label>
                    <input type="number" id="medianWidth" placeholder="Nh·∫≠p chi·ªÅu r·ªông (m)" step="0.01">
                </div>
                <div class="input-group">
                    <label for="sidewalkWidth">Chi·ªÅu r·ªông v·ªâa h√® :</label>
                    <input type="number" id="sidewalkWidth" placeholder="Nh·∫≠p chi·ªÅu r·ªông (m)" step="0.01">
                </div>
                <div class="input-group">
                    <label for="earthWidth">Chi·ªÅu r·ªông l·ªÅ ƒë·∫•t :</label>
                    <input type="number" id="earthWidth" placeholder="Nh·∫≠p chi·ªÅu r·ªông (m)" step="0.01">
                </div>
                 <div class="input-group">
                    <label for="bridgeWidth">Chi·ªÅu r·ªông c·∫ßu ph·∫ßn xe ch·∫°y :</label>
                    <input type="number" id="bridgeWidth" placeholder="Nh·∫≠p chi·ªÅu r·ªông (m)" step="0.01">
                </div>
                <div class="input-group">
                    <label for="railingWidth">Chi·ªÅu r·ªông lan can :</label>
                    <input type="number" id="railingWidth" placeholder="Nh·∫≠p chi·ªÅu r·ªông (m)" step="0.01">
                </div>
            </div>

            <!-- L·ª∞A CH·ªåN ƒê∆†N GI√Å -->
            <div class="section">
                <h2 class="section-title">L·ª±a Ch·ªçn ƒê∆°n Gi√°</h2>
                <div class="input-group">
                    <label>1. Ch·ªçn ƒë∆°n gi√° ph·∫ßn ƒë∆∞·ªùng:</label>
                    <div id="roadOptionsContainer" class="options-container"></div>
                </div>
                <div class="input-group">
                    <label>2. Ch·ªçn ƒë∆°n gi√° ph·∫ßn c·∫ßu:</label>
                    <div id="bridgeOptionsContainer" class="options-container"></div>
                </div>
                <div class="input-group">
                    <label>3. Ch·ªçn ƒë∆°n gi√° ph·∫ßn c·∫•p n∆∞·ªõc:</label>
                    <div id="waterSupplyOptionsContainer" class="options-container"></div>
                </div>
                <div class="input-group">
                    <label>4. Ch·ªçn ƒë∆°n gi√° c·ªëng tho√°t n∆∞·ªõc m∆∞a:</label>
                    <div id="infraOptionsContainer" class="options-container"></div>
                </div>
                 <div class="input-group">
                    <label>5. Ch·ªçn ƒë∆°n gi√° c√°p ƒëi·ªán & chi·∫øu s√°ng:</label>
                    <div id="powerCableOptionsContainer" class="options-container"></div>
                </div>
            </div>
            
            <!-- K·∫æT QU·∫¢ -->
            <div class="section results">
                <h2 class="section-title">K·∫øt Qu·∫£ T√≠nh To√°n</h2>
                <div class="results-content">
                    <div class="result-item">
                        <strong>Chi ph√≠ x√¢y d·ª±ng ph·∫ßn ƒë∆∞·ªùng:</strong>
                        <span class="result-value" id="roadCost">0</span>
                        <span class="unit">ƒë·ªìng</span>
                    </div>
                    <div class="result-item">
                        <strong>Chi ph√≠ x√¢y d·ª±ng ph·∫ßn c·∫ßu:</strong>
                        <span class="result-value" id="bridgeCost">0</span>
                        <span class="unit">ƒë·ªìng</span>
                    </div>
                    <div class="result-item">
                        <strong>Chi ph√≠ x√¢y d·ª±ng ph·∫ßn c·∫•p n∆∞·ªõc:</strong>
                        <span class="result-value" id="waterSupplyCost">0</span>
                        <span class="unit">ƒë·ªìng</span>
                    </div>
                    <div class="result-item">
                        <strong>Chi ph√≠ x√¢y d·ª±ng c·ªëng tho√°t n∆∞·ªõc:</strong>
                        <span class="result-value" id="infraCost">0</span>
                        <span class="unit">ƒë·ªìng</span>
                    </div>
                     <div class="result-item">
                        <strong>Chi ph√≠ XD c√°p ƒëi·ªán & chi·∫øu s√°ng:</strong>
                        <span class="result-value" id="powerCableCost">0</span>
                        <span class="unit">ƒë·ªìng</span>
                    </div>
                    <div class="result-item">
                        <strong>Chi·ªÅu r·ªông n·ªÅn ƒë∆∞·ªùng:</strong>
                        <span class="result-value" id="totalRoadWidth">0.00</span>
                        <span class="unit">m</span>
                    </div>
                    <div class="result-item">
                        <strong>Di·ªán t√≠ch m·∫∑t c·∫ßu:</strong>
                        <span class="result-value" id="bridgeArea">0.00</span>
                        <span class="unit">m¬≤</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            /**
             * ƒê·ªëi t∆∞·ª£ng ch√≠nh qu·∫£n l√Ω to√†n b·ªô ·ª©ng d·ª•ng
             */
            const CostEstimator = {
                // --- C·∫§U H√åNH ---
                // N∆°i ƒë·ªãnh nghƒ©a t·∫•t c·∫£ c√°c ID, t√™n v√† logic li√™n quan ƒë·∫øn c√°c ph·∫ßn c·ªßa ·ª©ng d·ª•ng.
                // Gi√∫p d·ªÖ d√†ng th√™m/b·ªõt h·∫°ng m·ª•c m√† kh√¥ng c·∫ßn s·ª≠a nhi·ªÅu code.
                config: {
                    jsonPath: './data/khai_toan_data.json',
                    // ƒê·ªãnh nghƒ©a c√°c √¥ nh·∫≠p li·ªáu
                    inputs: [
                        'roadLength', 'roadWidth', 'shoulderWidth', 'medianWidth', 
                        'sidewalkWidth', 'earthWidth', 'bridgeLength', 'bridgeWidth', 'railingWidth'
                    ],
                    // ƒê·ªãnh nghƒ©a c√°c h·∫°ng m·ª•c chi ph√≠
                    costCategories: [
                        { 
                            id: 'road', 
                            dataKey: 'suat_von_dau_tu_duong_o_to', 
                            containerId: 'roadOptionsContainer',
                            outputId: 'roadCost',
                            calculate: (state, costItem) => {
                                const roadLengthKm = (state.inputs.roadLength - state.inputs.bridgeLength) / 1000;
                                return roadLengthKm > 0 ? roadLengthKm * costItem.chi_phi_xay_dung * 1000000 : 0;
                            }
                        },
                        { 
                            id: 'bridge', 
                            dataKey: 'suat_von_dau_tu_cau', 
                            containerId: 'bridgeOptionsContainer',
                            outputId: 'bridgeCost',
                            calculate: (state, costItem) => state.results.bridgeArea * costItem.chi_phi_xay_dung * 1000
                        },
                        { 
                            id: 'waterSupply', 
                            dataKey: 'gia_xay_dung_tuyen_ong_cap_nuoc', 
                            containerId: 'waterSupplyOptionsContainer',
                            outputId: 'waterSupplyCost',
                            filter: item => item.don_vi === '1.000 ƒë/km',
                            calculate: (state, costItem) => (state.inputs.roadLength / 1000 * 2) * costItem.chi_phi_xay_dung * 1000
                        },
                        { 
                            id: 'infra', 
                            dataKey: 'gia_xay_dung_tuyen_cong_thoat_nuoc_mua', 
                            containerId: 'infraOptionsContainer',
                            outputId: 'infraCost',
                            filter: item => item.don_vi === '1.000 ƒë/km',
                            calculate: (state, costItem) => (state.inputs.roadLength / 1000 * 2) * costItem.chi_phi_xay_dung * 1000
                        },
                        { 
                            id: 'powerCable', 
                            dataKey: 'suat_von_dau_tu_duong_day_cap_dien_ha_the_0_4kV', 
                            containerId: 'powerCableOptionsContainer',
                            outputId: 'powerCableCost',
                            calculate: (state, costItem) => (state.inputs.roadLength / 1000 * 2) * costItem.chi_phi_xay_dung * 1000000
                        }
                    ],
                    // ƒê·ªãnh nghƒ©a c√°c k·∫øt qu·∫£ t√≠nh to√°n kh√°c
                    otherCalculations: {
                        totalRoadWidth: state => state.inputs.earthWidth * 2 + state.inputs.sidewalkWidth * 2 + state.inputs.shoulderWidth * 2 + state.inputs.medianWidth + state.inputs.roadWidth,
                        bridgeArea: state => state.inputs.bridgeLength * (state.inputs.railingWidth * 2 + state.inputs.bridgeWidth)
                    }
                },

                // --- TR·∫†NG TH√ÅI ---
                // L∆∞u tr·ªØ t·∫•t c·∫£ d·ªØ li·ªáu ƒë·ªông c·ªßa ·ª©ng d·ª•ng.
                state: {
                    costData: {},
                    inputs: {},
                    selectedOptions: {},
                    results: {}
                },

                // --- B·ªò ƒê·ªÜM DOM ---
                // L∆∞u tr·ªØ c√°c tham chi·∫øu ƒë·∫øn ph·∫ßn t·ª≠ DOM ƒë·ªÉ tr√°nh truy v·∫•n l·∫∑p l·∫°i.
                elements: {},

                /**
                 * Kh·ªüi t·∫°o ·ª©ng d·ª•ng
                 */
                async init() {
                    this.cacheElements();
                    this.setupEventListeners();
                    try {
                        await this.fetchData();
                        this.createAllOptionCards();
                        this.updateAndCalculate();
                    } catch (error) {
                        console.error("Kh√¥ng th·ªÉ kh·ªüi t·∫°o ·ª©ng d·ª•ng:", error);
                        this.showError(`L·ªói: ${error.message}. Vui l√≤ng ki·ªÉm tra l·∫°i ƒë∆∞·ªùng d·∫´n t·ªáp data.json v√† ƒë·∫£m b·∫£o n√≥ h·ª£p l·ªá.`);
                    }
                },

                /**
                 * L∆∞u c√°c ph·∫ßn t·ª≠ DOM c·∫ßn thi·∫øt v√†o b·ªô ƒë·ªám
                 */
                cacheElements() {
                    this.elements.errorMessage = document.getElementById('errorMessage');
                    this.config.inputs.forEach(id => {
                        this.elements[id] = document.getElementById(id);
                    });
                    // Cache all output elements
                    const outputIds = Object.keys(this.config.otherCalculations).concat(
                        this.config.costCategories.map(cat => cat.outputId)
                    );
                    outputIds.forEach(id => {
                        this.elements[id] = document.getElementById(id);
                    });
                },

                /**
                 * T·∫£i d·ªØ li·ªáu chi ph√≠ t·ª´ file JSON
                 */
                async fetchData() {
                    const response = await fetch(this.config.jsonPath);
                    if (!response.ok) {
                        throw new Error(`L·ªói m·∫°ng: ${response.statusText}`);
                    }
                    this.state.costData = await response.json();
                },

                /**
                 * C√†i ƒë·∫∑t c√°c tr√¨nh l·∫Øng nghe s·ª± ki·ªán
                 */
                setupEventListeners() {
                    const form = document.querySelector('.content');
                    form.addEventListener('input', this.handleInputChange.bind(this));
                },

                /**
                 * X·ª≠ l√Ω s·ª± ki·ªán khi ng∆∞·ªùi d√πng thay ƒë·ªïi gi√° tr·ªã nh·∫≠p li·ªáu
                 */
                handleInputChange(event) {
                    if (event.target.type === 'radio') {
                        this.handleCardSelection(event.target);
                    }
                    this.updateAndCalculate();
                },
                
                /**
                 * C·∫≠p nh·∫≠t tr·∫°ng th√°i, t√≠nh to√°n v√† hi·ªÉn th·ªã l·∫°i k·∫øt qu·∫£
                 */
                updateAndCalculate() {
                    this.updateStateFromDOM();
                    this.calculateAll();
                    this.render();
                },

                /**
                 * C·∫≠p nh·∫≠t ƒë·ªëi t∆∞·ª£ng state t·ª´ gi√° tr·ªã hi·ªán t·∫°i trong DOM
                 */
                updateStateFromDOM() {
                    // C·∫≠p nh·∫≠t gi√° tr·ªã inputs
                    this.config.inputs.forEach(id => {
                        this.state.inputs[id] = parseFloat(this.elements[id].value) || 0;
                    });

                    // C·∫≠p nh·∫≠t c√°c l·ª±a ch·ªçn ƒë∆°n gi√°
                    this.config.costCategories.forEach(cat => {
                        const selectedRadio = document.querySelector(`input[name="${cat.id}CostType"]:checked`);
                        this.state.selectedOptions[cat.id] = selectedRadio ? selectedRadio.value : null;
                    });
                },

                /**
                 * Th·ª±c hi·ªán t·∫•t c·∫£ c√°c ph√©p t√≠nh
                 */
                calculateAll() {
                    const { inputs, costData, selectedOptions } = this.state;

                    // T√≠nh c√°c gi√° tr·ªã h√¨nh h·ªçc
                    for (const key in this.config.otherCalculations) {
                        this.state.results[key] = this.config.otherCalculations[key](this.state);
                    }

                    // T√≠nh c√°c chi ph√≠
                    this.config.costCategories.forEach(cat => {
                        const selectedKey = selectedOptions[cat.id];
                        const dataGroup = costData[cat.dataKey];
                        let cost = 0;
                        if (selectedKey && dataGroup && dataGroup[selectedKey]) {
                            cost = cat.calculate(this.state, dataGroup[selectedKey]);
                        }
                        this.state.results[cat.outputId] = cost;
                    });
                },

                /**
                 * Hi·ªÉn th·ªã t·∫•t c·∫£ k·∫øt qu·∫£ ra giao di·ªán
                 */
                render() {
                    for (const key in this.state.results) {
                        const element = this.elements[key];
                        if (element) {
                            const value = this.state.results[key];
                            const isCurrency = key.toLowerCase().includes('cost');
                            element.textContent = isCurrency ? this.formatCurrency(value) : this.formatNumber(value);
                            this.animateValueUpdate(element);
                        }
                    }
                },
                
                /**
                 * T·∫°o t·∫•t c·∫£ c√°c th·∫ª l·ª±a ch·ªçn ƒë∆°n gi√° d·ª±a tr√™n c·∫•u h√¨nh
                 */
                createAllOptionCards() {
                    this.config.costCategories.forEach(cat => {
                        let data = this.state.costData[cat.dataKey] || {};
                        if (cat.filter) {
                            data = Object.fromEntries(Object.entries(data).filter(([key, value]) => cat.filter(value)));
                        }
                        this.createOptionCards(cat.containerId, data, `${cat.id}CostType`);
                    });
                },

                /**
                 * T·∫°o c√°c th·∫ª l·ª±a ch·ªçn cho m·ªôt h·∫°ng m·ª•c c·ª• th·ªÉ
                 */
                createOptionCards(containerId, data, name) {
                    const container = document.getElementById(containerId);
                    if (!container) return;
                    container.innerHTML = '';

                    if (!data || Object.keys(data).length === 0) {
                        container.innerHTML = '<p>Kh√¥ng c√≥ d·ªØ li·ªáu ph√π h·ª£p.</p>';
                        return;
                    }

                    Object.entries(data).forEach(([key, item], index) => {
                        const card = document.createElement('label');
                        card.className = 'option-card';
                        if (index === 0) card.classList.add('selected');

                        const radio = document.createElement('input');
                        radio.type = 'radio';
                        radio.name = name;
                        radio.value = key;
                        if (index === 0) radio.checked = true;
                        
                        const displayUnit = item.don_vi
                            .replace('tri·ªáu ƒë·ªìng/km', 'trƒë/km')
                            .replace('1.000 ƒë/m2', 'ngh√¨n ƒë/m¬≤')
                            .replace('1.000 ƒë/km', 'ngh√¨n ƒë/km');

                        card.innerHTML = `
                            <p><strong>${item.nhom} (M√£: ${key})</strong></p>
                            <p>${item.mo_ta}</p>
                            <p><strong>Chi ph√≠ XD:</strong> <span class="cost">${this.formatCurrency(item.chi_phi_xay_dung)}</span> ${displayUnit}</p>
                        `;
                        card.prepend(radio);
                        container.appendChild(card);
                    });
                },

                /**
                 * X·ª≠ l√Ω hi·ªáu ·ª©ng giao di·ªán khi ch·ªçn th·∫ª
                 */
                handleCardSelection(radioElement) {
                    const container = radioElement.closest('.options-container');
                    if (!container) return;
                    container.querySelectorAll('.option-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    radioElement.closest('.option-card').classList.add('selected');
                },

                // --- C√ÅC H√ÄM TI·ªÜN √çCH ---
                formatCurrency: num => isNaN(num) || !isFinite(num) ? '0' : Math.round(num).toLocaleString('vi-VN'),
                formatNumber: num => isNaN(num) || !isFinite(num) ? '0.00' : num.toFixed(2),
                animateValueUpdate(element) {
                    element.classList.add('value-updated');
                    setTimeout(() => element.classList.remove('value-updated'), 300);
                },
                showError(message) {
                    this.elements.errorMessage.textContent = message;
                    this.elements.errorMessage.style.display = 'block';
                }
            };

            // Kh·ªüi ch·∫°y ·ª©ng d·ª•ng
            CostEstimator.init();
        });
    </script>
</body>
</html>
